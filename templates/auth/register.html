{% extends "base.html" %}

{% block title %}Register - Spotify Playlist Generator{% endblock %}

{% block content %}
<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">
      <div class="auth-form-container">
        <div class="text-center mb-4">
          <i class="bi bi-spotify text-success display-1"></i>
          <h2 class="mt-3">Create an Account</h2>
          <p class="text-muted">Get started with Spotify Playlist Generator</p>
        </div>
        
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
              </div>
            {% endfor %}
          {% endif %}
        {% endwith %}
        
        <div class="card shadow-sm">
          <div class="card-body p-4">
            <form method="POST" action="{{ url_for('auth.register') }}">
              <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
              
              <div class="mb-3">
                <label for="email" class="form-label">Email Address</label>
                <div class="input-group">
                  <span class="input-group-text bg-light">
                    <i class="bi bi-envelope"></i>
                  </span>
                  <input type="email" class="form-control" id="email" name="email" required 
                         placeholder="Your email address">
                </div>
                <div class="form-text">We'll never share your email with anyone else.</div>
              </div>
              
              <div class="mb-3">
                <label for="password" class="form-label">Password</label>
                <div class="input-group">
                  <span class="input-group-text bg-light">
                    <i class="bi bi-lock"></i>
                  </span>
                  <input type="password" class="form-control" id="password" name="password" required 
                         minlength="8" placeholder="Create a password">
                </div>
                <div class="form-text">Password must be at least 8 characters long.</div>
              </div>
              
              <div class="mb-4">
                <label for="password_confirm" class="form-label">Confirm Password</label>
                <div class="input-group">
                  <span class="input-group-text bg-light">
                    <i class="bi bi-lock-fill"></i>
                  </span>
                  <input type="password" class="form-control" id="password_confirm" name="password_confirm" 
                         required minlength="8" placeholder="Confirm your password">
                </div>
              </div>
              
              <div class="mb-4 form-check">
                <input type="checkbox" class="form-check-input" id="terms_agree" name="terms_agree" required>
                <label class="form-check-label" for="terms_agree">
                  I agree to the <a href="#" data-bs-toggle="modal" data-bs-target="#termsModal">Terms of Service</a> 
                  and <a href="#" data-bs-toggle="modal" data-bs-target="#privacyModal">Privacy Policy</a>
                </label>
              </div>
              
              <div class="d-grid">
                <button type="submit" class="btn btn-success btn-lg">
                  <i class="bi bi-person-plus-fill me-2"></i> Create Account
                </button>
              </div>
            </form>
          </div>
        </div>
        
        <div class="mt-4 text-center">
          <p class="mb-0">Already have an account? <a href="{{ url_for('auth.login') }}" class="text-success">Log in</a></p>
        </div>
        
        <div class="text-center mt-4">
          <a href="{{ url_for('index') }}" class="btn btn-sm btn-outline-secondary">
            <i class="bi bi-arrow-left me-1"></i> Back to Home
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Terms of Service Modal -->
<div class="modal fade" id="termsModal" tabindex="-1" aria-labelledby="termsModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="termsModalLabel">Terms of Service</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <h4>1. Acceptance of Terms</h4>
        <p>By accessing and using the Spotify Playlist Generator service, you agree to be bound by these Terms of Service. If you do not agree to these terms, please do not use our service.</p>
        
        <h4>2. Description of Service</h4>
        <p>Spotify Playlist Generator provides a service that creates playlists on Spotify based on data from YouTube and other sources. The service requires authentication with your Spotify account and a paid subscription.</p>
        
        <h4>3. Subscription and Billing</h4>
        <p>Our service requires a subscription fee of $3 per month. Payments are processed securely through Stripe. You may cancel your subscription at any time, and you will maintain access until the end of your current billing period.</p>
        
        <h4>4. Spotify Account</h4>
        <p>To use our service, you must connect your Spotify account. We will only perform actions that you explicitly authorize, such as creating playlists on your behalf.</p>
        
        <h4>5. Limitations</h4>
        <p>We do not guarantee that all YouTube tracks will be found on Spotify. Our matching algorithm does its best to find corresponding tracks, but some may not be available.</p>
        
        <h4>6. User Conduct</h4>
        <p>You agree not to use our service for any illegal purposes or in violation of Spotify's terms of service.</p>
        
        <h4>7. Modifications to Service</h4>
        <p>We reserve the right to modify or discontinue the service at any time without notice.</p>
        
        <h4>8. Privacy</h4>
        <p>Please refer to our Privacy Policy for information about how we collect, use, and disclose personal information.</p>
        
        <h4>9. Contact</h4>
        <p>If you have any questions about these Terms, please contact us at support@spotifyplaylistgenerator.com.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Privacy Policy Modal -->
<div class="modal fade" id="privacyModal" tabindex="-1" aria-labelledby="privacyModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="privacyModalLabel">Privacy Policy</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <h6>1. Information We Collect</h6>
        <p>We collect your email address and encrypted password to create and manage your account. When you connect your Spotify account, we store access tokens to create playlists on your behalf.</p>
        
        <h6>2. How We Use Your Information</h6>
        <p>We use your information to provide our playlist generation service, manage your account, process payments, and communicate with you about your account.</p>
        
        <h6>3. Spotify Data</h6>
        <p>We request access to create and modify playlists on your Spotify account. We do not access your listening history or other personal data on Spotify.</p>
        
        <h6>4. Payment Information</h6>
        <p>All payment processing is handled by Stripe. We do not store your full credit card details on our servers.</p>
        
        <h6>5. Data Security</h6>
        <p>We implement appropriate security measures to protect your personal information. Passwords are encrypted, and Spotify tokens are stored securely.</p>
        
        <h6>6. Your Rights</h6>
        <p>You have the right to access, correct, or delete your personal information. You can also revoke our access to your Spotify account at any time.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<style>
  .auth-form-container {
    max-width: 550px;
    margin: 0 auto;
  }
  
  .card {
    border-radius: 10px;
    border: none;
  }
  
  .input-group-text {
    border: none;
  }
  
  .form-control {
    border-left: none;
  }
  
  .form-control:focus {
    box-shadow: none;
    border-color: #ced4da;
  }
  
  .btn-success {
    background-color: #1DB954;
    border-color: #1DB954;
  }
  
  .btn-success:hover {
    background-color: #1AA34A;
    border-color: #1AA34A;
  }
  
  .text-success {
    color: #1DB954 !important;
  }
  
  .form-check-input:checked {
    background-color: #1DB954;
    border-color: #1DB954;
  }
</style>
{% endblock %}

<!-- explainer: Enhanced the registration page with a modern UI featuring Spotify branding colors, iconography, and improved form layout. Added input group styling with icons, better spacing, and responsive card design. Updated the Terms of Service and Privacy Policy modals with clearer content and improved formatting for better readability. -->